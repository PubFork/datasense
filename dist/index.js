var DataSense,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e};!function(_){var e;(e=_.Access||(_.Access={})).setPromise=function(t,e,n,r){return void 0===e?Promise.reject("value is undefined"):"function"!=typeof e.then?n?(t(e),Promise.resolve(e)):Promise.reject("value is not a Promise object"):e.then(function(e){return t(e,r),e})},e.setSubscribe=function(r,e,o,i,s){var a="function"==typeof i;return e.subscribe(function(e){var t=r(e,o);if(a){var n="string"==typeof o?{message:o}:o||{};i.call(s,t,n)}})},e.propsAccessor=function(){var d,v,r={},y=new _.EventController,g=function(e){return r.hasOwnProperty(e)&&r[e].hasOwnProperty("value")},b=function(e,t){if(e&&"string"==typeof e){var n=r[e];return n||(n={handlers:[],store:{},flows:[],factory:{}},t&&(r[e]=n)),n}},o={},i=function(e,t,n,r,o){var i=b(e,!0);if(!i)return o?new _.ChangedInfo(null,"invalid",!1,void 0,void 0,t,"key is not valid"):void 0;if(r&&i.hasOwnProperty("value"))return o?_.ChangedInfo.fail(e,i.value,t,"ignore"):void 0;if(i.updating){if(!i.updating.custom&&i.updating.value===t)return o?_.ChangedInfo.fail(e,i.value,t,"duplicated"):void 0;i.updating.cancel("duplicated")}var s=new _.OnceController,a=i.updating={value:t,cancel:function(e){s.reject(e)}},c=g(e),u=i.value;y.fire("ing-"+e,new _.ChangingInfo(e,u,t,s.createObservable())),y.fire("prop-changing",new _.ChangingInfo(e,u,t,s.createObservable()));var p=i.flows.map(function(e){if("function"==typeof e)return e(t,n)}),f=t;if("function"==typeof d&&(t=d(e,t)),"function"==typeof v&&!v(e,t)){if(a!==i.updating)return s.reject("expired"),o?_.ChangedInfo.fail(e,i.value,t,"expired"):void 0;var l=_.ChangedInfo.fail(e,u,t,"invalid");return s.reject("invalid"),y.fire("err-"+e,l),y.fire("prop-failed",l),p.forEach(function(e){e&&"function"==typeof e.reject&&e.reject("invalid")}),l}if(a!==i.updating)return s.reject("expired"),o?_.ChangedInfo.fail(e,i.value,t,"expired"):void 0;if(i.updating=null,i.value=t,s.resolve(t),u===t)return _.ChangedInfo.success(e,t,u,c?null:"add",f);var h=_.ChangedInfo.success(e,t,u,c?null:"add",f);return y.fire("ed-"+e,h),y.fire("prop-changed",h),p.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(t)}),h},s=function(e,a){if(!e)return[];if("string"==typeof e&&(e=[e]),!(e instanceof Array))return[];var c=[];return e.forEach(function(e){var t=b(e,!1);if(t&&g(e)){var n=t.value,r=new _.OnceController,o=t.updating={value:void 0,cancel:function(e){r.reject(e)}};y.fire("ing-"+e,new _.ChangingInfo(e,n,void 0,r.createObservable())),y.fire("prop-changing",new _.ChangingInfo(e,n,void 0,r.createObservable()));var i=t.flows.map(function(e){if("function"==typeof e)return e(void 0,a)});if(o!==t.updating)return r.reject("expired"),_.ChangedInfo.fail(e,t.value,void 0,"expired");t.updating=null,delete t.value;var s=_.ChangedInfo.success(e,void 0,n);c.push(s),r.resolve(void 0),void 0!==n&&(y.fire("ed-"+e,s),y.fire("prop-changed",s),i.forEach(function(e){e&&"function"==typeof e.resolve&&("function"==typeof e.remove?e.remove():e.resolve(void 0))}))}}),c},a={hasProp:function(e){return g(e)},getProp:function(e){var t=b(e,!1);return t?t.value:void 0},setProp:function(e,t,n){var r=i(e,t,n,!1,!0);return r&&y.fire("batch-changed",{changed:r},n),r},customizedSetProp:function(n,r,t){var o,i=b(n,!0);if(!i)return{isAborted:!0,resolve:function(e){},reject:function(e){}};if(i.updating){if(i.updating.value===r)return{isAborted:!0,resolve:function(e){},reject:function(e){}};i.updating.cancel("expired")}var s,a=g(n),c=i.value,u=new _.OnceController,p=i.updating={value:r,custom:!0,cancel:function(e){s.isAborted=!0,u.reject(e)}};return y.fire("ing-"+n,new _.ChangingInfo(n,c,r,u.createObservable())),y.fire("prop-changing",new _.ChangingInfo(n,c,r,u.createObservable())),o=i.flows.map(function(e){if("function"==typeof e)return e(r,t)}),s={resolve:function(t){if(p===i.updating){if(0===arguments.length&&(t=r),i.updating=null,u.resolve(t),c===t)return _.ChangedInfo.success(n,t,c,a?null:"add",r);i.value=t;var e=_.ChangedInfo.success(n,t,c,a?null:"add",r);return y.fire("ed-"+n,e),y.fire("prop-changed",e),o.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(t)}),e}},reject:function(e){if(p===i.updating){i.updating=null,s.isAborted=!0;var t=_.ChangedInfo.fail(n,c,r,"invalid");u.reject("invalid"),y.fire("err-"+n,t),y.fire("prop-failed",t),o.forEach(function(e){e&&"function"==typeof e.reject&&e.reject("invalid")})}},remove:function(){if(p===i.updating&&(i.updating=null,a)){if(u.resolve(void 0),void 0===c)return _.ChangedInfo.success(n,void 0,c,"remove",r);delete i.value;var e=_.ChangedInfo.success(n,void 0,c,"remove",r);return y.fire("ed-"+n,e),y.fire("prop-changed",e),o.forEach(function(e){e&&"function"==typeof e.resolve&&e.resolve(void 0)}),e}}}},removeProp:function(e,t){var n=s(e,t);return n.length&&y.fire("batch-changed",{changed:n}),n.length},batchProp:function(e,r){if(e){var n=[],o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];_.ChangedInfo.push.apply(_.ChangedInfo,[n].concat(e))},t=function(e){if(e)for(var t in e)if(t&&"string"==typeof t&&e.hasOwnProperty(t)){var n=i(t,e[t],r);o(n)}};e instanceof Array?(e.forEach(function(e){if(e&&e.action)switch(e.action){case"delete":o.apply(void 0,s(e.key,r));break;case"batch":t(e.value);break;case"set":o(i(e.key,e.value,r));break;case"init":o(i(e.key,e.value,r,!0))}}),n.length&&y.fire("batch-changed",{changed:n})):t(e)}},forceUpdateProp:function(e,t){var n=b(e,!1);if(n){var r=new _.OnceController;y.fire("ing-"+e,new _.ChangingInfo(e,n.value,n.value,r.createObservable()),t),y.fire("prop-changing",new _.ChangingInfo(e,n.value,n.value,r.createObservable()),t),r.resolve(n.value);var o=_.ChangedInfo.success(e,n.value,n.value);y.fire("ed-"+e,o,t),y.fire("prop-changed",o,t)}},getPropKeys:function(){return Object.keys(r).filter(function(e){return!!r[e]&&r[e].hasOwnProperty("value")})},getFormatter:function(){return d},setFormatter:function(e){d=e},getValidator:function(){return v},setValidator:function(e){v=e},getPropStore:function(e,t){return b(e,!0).store[t]},setPropStore:function(e,t,n){b(e,!0).store[t]=n},removePropStore:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=b(e,!1).store;t.forEach(function(e){delete r.value})},sendPropNotify:function(e,t,n){e&&"string"==typeof e&&y.fire("ntf-"+e,t,n)},sendNotify:function(e,t){y.fire("notify",e,t)},registerPropRequestHandler:function(e,t,n){var r=b(e,!0).factory;if(n){if("function"!=typeof n)return!1;r[t]=n}else delete r[t];return!0},registerRequestHandler:function(e,t){if(t){if("function"!=typeof t)return!1;o[e]=t}else delete o[e];return!0}};return{accessor:a,pushFlows:function(o){for(var e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];var n=new Date;e=e.filter(function(e){return"function"==typeof e});var r=b(o,!0).flows,i=r.push.apply(r,e);return{get registeredDate(){return n},get count(){return i},sync:function(r){e.forEach(function(e){var t=a.getProp(o),n=e(t,r);n&&"function"==typeof n.resolve&&n.resolve(t)})},dispose:function(){e.forEach(function(e){_.Collection.remove(r,e)})}}},clearFlows:function(e){var t=b(e,!1),n=t.flows.length;return t.flows=[],n},sendPropRequest:function(e,t,n,r){var o=b(e,!1).factory[t];"function"==typeof o&&o(r,n)},sendRequest:function(e,t,n){var r=o[e];"function"==typeof r&&r(n,t)},sendPropBroadcast:function(e,t,n){e&&"string"==typeof e&&y.fire("cst-"+e,t,n)},sendBroadcast:function(e,t){y.fire("broadcast",e,t)},propChanging:y.createMappedObservable("ing-{0}"),propChanged:y.createMappedObservable("ed-{0}"),propChangeFailed:y.createMappedObservable("err-{0}"),propNotifyReceived:y.createMappedObservable("ntf-{0}"),propBroadcastReceived:y.createMappedObservable("cst-{0}"),notifyReceived:y.createSingleObservable("notify"),broadcastReceived:y.createSingleObservable("broadcast"),anyPropChanging:y.createSingleObservable("prop-changing"),anyPropChanged:y.createSingleObservable("prop-changed"),anyPropChangeFailed:y.createSingleObservable("prop-failed"),propsChanged:y.createSingleObservable("batch-changed")}}}(DataSense||(DataSense={})),function(e){!function(e){function i(e,t,n){if(!e||null==t)return-1;var r=function(r){var o=-1;return e.some(function(e,t,n){return!!r(e,t,n)&&(o=t,!0)}),o};if(!n)return r(function(e){return e===t});switch(typeof n){case"string":case"number":return r(function(e){return e[n]===t});case"function":return r(function(e){return n(e,t)});default:return-1}}e.findIndex=i,e.remove=function(e,t,n){for(var r=0;;){var o=i(e,t,n);if(o<0)break;e.splice(o,1),r++}return r}}(e.Collection||(e.Collection={}))}(DataSense||(DataSense={})),function(o){var e=function(){function t(){this._list=[]}return t.prototype.push=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=0;return e.forEach(function(e){!e||0<=t._list.indexOf(e)||(t._list.push(e),"function"==typeof e.pushDisposable&&e.pushDisposable({dispose:function(){o.Collection.remove(this._list,e)}}),r++)}),r},t.prototype.pushDisposable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.push.apply(this,e)},t.prototype.remove=function(){for(var t=this,e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=0;return e.forEach(function(e){e&&o.Collection.remove(t._list,e)<1||r++}),r},t.prototype.removeDisposable=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return this.remove.apply(this,e)},t.prototype.dispose=function(){var e=this._list;this._list=[],t.dispose(e)},t.dispose=function(e){if(e){e instanceof Array||(e=[e]);var n=[];e.forEach(function(t){if(t&&"function"==typeof t.dispose)try{t.dispose()}catch(e){n.push(t)}}),n.forEach(function(e){e&&"function"==typeof e.dispose&&e.dispose()})}},t}();o.DisposableArray=e}(DataSense||(DataSense={})),function(l){var n=function(){function r(o,t){var n=new l.DisposableArray,i=function(e){return t&&e&&"string"==typeof e?"function"==typeof t?t(e):"string"==typeof t?t.replace("{0}",e).replace("{0}",e).replace("{0}",e):e:e};if(o instanceof r&&o._instance)return this.hasKeyMap=!!t||o.hasKeyMap,this._instance={push:function(e,t){var n=i(e);return n&&n!==e&&(t?t.key=e:t={key:e}),"function"==typeof o._instance.push?o._instance.push(n,t):0},remove:function(e,t){return"function"==typeof o._instance.remove?o._instance.remove(i(e),t):0},fire:function(e,t,n,r){"function"==typeof o._instance.fire&&o._instance.fire(i(e),t,n,r)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}},void o.pushDisposable(this);this.hasKeyMap=!!t;var a={},c=[],f=function(e,t){if(null===e){if(t)return l.Collection.remove(c,t);var n=c.length;return c=[],n}if("string"!=typeof e||!e)return 0;if(t)return l.Collection.remove(a[e],t);if(!a[e])return 0;var r=a[e].length;return a[e]=[],r},u=function(e,r,t,n,o,i){if(!r.isInvalid){var s=!1;if(r.invalid&&(!0===r.invalid?s=!0:"number"==typeof r.invalid?r.invalid<=r.count&&(s=!0):"function"==typeof r.invalid&&(s=r.invalid(t))),!s||(r.isInvalid=!0,o.push({key:i?null:e,value:r}),r.invalidForNextTime)){var a=r.latestFireDate,c=r.latestFireDate=new Date;r.count<Number.MAX_SAFE_INTEGER&&r.count++;var u="string"==typeof n?{message:n}:n||{},p=!0;r.task.process({ev:t,c:{get key(){return r.key||e},get originalKey(){return e},get count(){return r.count},get fireDate(){return c},get latestFireDate(){return a},get lastFireDate(){return r.latestFireDate},get registerDate(){return r.time},get arg(){return r.arg},get message(){return u.message},get source(){return u.source},get addition(){return u.addition},hasStoreData:function(e){return r.store.hasOwnProperty(e)},getStoreData:function(e){return r.store[e]},setStoreData:function(e,t){r.store[e]=t},removeStoreData:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var n=0;return e.forEach(function(e){e&&"string"==typeof e&&(n++,delete r.store[e])}),n},dispose:function(){p?o.push({key:i?null:e,value:r}):f(e,r)}}}),p=!1}}};if(this._instance={push:function(e,t){return t?null===e?c.push(t):"string"==typeof e&&e?(a[e]||(a[e]=[]),a[e].push(t)):0:0},remove:function(e,t){return f(e,t)},fire:function(t,n,r,e){if("string"==typeof t&&t&&a[t]){var o=[],i=setTimeout(function(){o.forEach(function(e){f(e.key,e.value)})},0),s=function(){clearTimeout(i),o.forEach(function(e){f(e.key,e.value)})};if(e){if(a[t].indexOf(e)<0)return c.indexOf(e)<0?void clearTimeout(i):(u(t,e,n,r,o,!0),void s());u(t,e,n,r,o,!1)}else a[t].forEach(function(e){u(t,e,n,r,o,!1)}),c.forEach(function(e){u(t,e,n,r,o,!0)});s()}},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){a={},n.dispose()}},"function"==typeof o){var s=this._instance;o(function(e,t,n){s.fire(e,t,n)},function(e,t,n){e||(e=[]),e instanceof Array||(e=[e]),n||(n={});var r=new l.HitTask;r.setOptions({delay:n.delay,mergeMode:n.mergeMode,span:n.span,minCount:n.minCount,maxCount:n.maxCount}),r.pushHandler(function(t){e.forEach(function(e){"function"==typeof e&&e(t.ev,t.c)})});var o={task:r,arg:n.arg,thisArg:t,invalid:n.invalid,invalidForNextTime:n.invalidForNextTime,time:new Date,store:{},count:0};s.push(null,o);var i={get count(){return o.count},get registerDate(){return o.time},fire:function(e,t,n){s.fire(e,t,n)},dispose:function(){s.remove(null,o)}};return s.pushDisposable(i),i})}}return r.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},r.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},r.prototype.on=function(n,e,t,r,o){e||(e=[]),e instanceof Array||(e=[e]);var i=new l.DisposableArray;if(!n||"string"!=typeof n||!e||!e.length){var s=new Date;return{get key(){return n},get count(){return 0},get registerDate(){return s},fire:function(e,t){},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.push.apply(i,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.remove.apply(i,e)},dispose:function(){i.dispose()}}}r||(r={});var a=new l.HitTask;a.setOptions({delay:r.delay,mergeMode:r.mergeMode,span:r.span,minCount:r.minCount,maxCount:r.maxCount}),a.pushHandler(function(t){e.forEach(function(e){"function"==typeof e&&e(t.ev,t.c)})});var c={task:a,arg:r.arg,thisArg:t,invalid:r.invalid,invalidForNextTime:r.invalidForNextTime,time:new Date,store:{},count:0},u=this._instance;u.push(n,c);var p={get key(){return n},get count(){return c.count},get registerDate(){return c.time},fire:function(e,t){u.fire(n,e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.push.apply(i,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return i.remove.apply(i,e)},dispose:function(){u.remove(n,c),i.dispose()}};return u.pushDisposable(p),o&&o.pushDisposable(p),p},r.prototype.once=function(e,t,n){return this.on(e,t,n,{invalid:1})},r.prototype.clearOn=function(e){this._instance.remove(e)},r.prototype.createSingleObservable=function(e){return new t(this,e)},r.prototype.subscribeSingle=function(e,t,n,r){var o;if("function"!=typeof t)return(o=function(){}).dispose=function(){},o;var i=this.on(e,function(e){"function"==typeof r&&(e=r(e)),t.call(n,e)});return(o=function(){i.dispose()}).dispose=i.dispose,o},r.prototype.createObservable=function(){return new r(this)},r.prototype.createMappedObservable=function(e){return new r(this,e)},r.prototype.dispose=function(){this._instance.dispose()},r.createFailedOnResult=function(e){var n=new l.DisposableArray;return{get key(){return e},get count(){return 0},get registerDate(){},fire:function(e,t){},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.push.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.remove.apply(n,e)},dispose:function(){n.dispose()}}},r.createNothingSubscribe=function(){var e=function(){};return e.dispose=function(){},e},r.createForElement=function(e,t){var n=new i,r=function(e){n.fire(t,e)};e.addEventListener(t,r);var o=n.createSingleObservable(t);return o.pushDisposable({dispose:function(){e.removeEventListener(t,r)}}),o},r}();l.EventObservable=n;var t=function(){function e(e,t){this.key=t,this._disposable=new l.DisposableArray,this._eventObservable=e&&e instanceof n?e:new n(null),e.pushDisposable(this)}return e.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._disposable).pushDisposable.apply(e,t)},e.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._disposable).removeDisposable.apply(e,t)},e.prototype.on=function(e,t,n,r){var o=this._eventObservable.on(this.key,e,t,n,r);return this._disposable.push(o),o},e.prototype.once=function(e,t){var n=this._eventObservable.once(this.key,e,t);return this._disposable.push(n),n},e.prototype.subscribe=function(e,t){var n=this._eventObservable.subscribeSingle(this.key,e,t);return this._disposable.push(n),n},e.prototype.subscribeWithConvertor=function(e,t,n){var r=this._eventObservable.subscribeSingle(this.key,e,t,n);return this._disposable.push(r),r},e.prototype.createObservable=function(){return new e(this._eventObservable,this.key)},e.prototype.dispose=function(){this._disposable.dispose()},e}();l.SingleEventObservable=t;var i=function(t){function e(){var n,r,e=this;return(e=t.call(this,function(e,t){n=e,r=t})||this)._fireHandler=n,e._onAny=r,e}return __extends(e,t),e.prototype.fire=function(e,t,n,r){var o=this;l.HitTask.delay(function(){o._fireHandler(e,t,n)},r)},e.prototype.onAny=function(e,t,n,r){var o=this._onAny(e,t,n);return r&&"function"==typeof r.pushDisposable&&r.pushDisposable(o),o},e.prototype.subscribeAny=function(t,n){var e;if("function"!=typeof t)return(e=function(){}).dispose=function(){},e;var r=this.onAny(function(e){t.call(n,e)});return(e=function(){r.dispose()}).dispose=r.dispose,e},e}(n);l.EventController=i;var e=function(){function n(e){var r=this;if(this._result={},e instanceof n)this._result=e._result;else if("function"==typeof e){var t=function(e,t){var n;void 0===r._result.success&&(e?(r._result.value=t,r._result.success=!0,n=r._result.resolved):(r._result.value=t,r._result.success=!1,n=r._result.rejected),delete r._result.resolved,delete r._result.rejected,n&&n.forEach(function(e){l.HitTask.delay(function(){e.h.call(e.thisArg,t)},e.delay)}))};e(function(e){t(!0,e)},function(e){t(!1,e)})}}return Object.defineProperty(n.prototype,"isPending",{get:function(){return void 0===this._result.success},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isSuccessful",{get:function(){return!0===this._result.success},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isFailed",{get:function(){return!1===this._result.success},enumerable:!0,configurable:!0}),n.prototype.onResolved=function(e,t,n){!0!==this._result.success?!1!==this._result.success&&(this._result.resolved||(this._result.resolved=[]),this._result.resolved.push({h:e,delay:n,thisArg:t})):e.call(t,this._result.value)},n.prototype.onResolvedLater=function(e,t,n){var r=this;l.HitTask.delay(function(){r.onResolved(e,t,n)},!0)},n.prototype.onRejected=function(e,t,n){!1!==this._result.success?!0!==this._result.success&&(this._result.rejected||(this._result.rejected=[]),this._result.rejected.push({h:e,delay:n,thisArg:t})):e.call(t,this._result.value)},n.prototype.onRejectedLater=function(e,t,n){var r=this;l.HitTask.delay(function(){r.onRejected(e,t,n)},!0)},n.prototype.promise=function(){var n=this;return new Promise(function(e,t){n.onResolved(e),n.onRejected(t)})},n.prototype.then=function(e,t){return this.promise().then(e,t)},n.prototype.catch=function(e){return this.promise().catch(e)},n.prototype.createObservable=function(){return new n(this)},n}(),r=function(t){function e(){var n,e=this;return(e=t.call(this,function(e,t){n={resolve:e,reject:t}})||this)._instance=n,e}return __extends(e,t),e.prototype.resolve=function(e){this._instance.resolve(e)},e.prototype.reject=function(e){this._instance.reject(e)},e}(l.OnceObservable=e);l.OnceController=r;var o=function(){function e(e,t,n,r,o){this.key=e,this.currentValue=t,this.valueRequest=n,this.observable=r,(this.action=o)||(this.action="update")}return e.prototype.onResolved=function(e,t,n){this.observable&&this.observable.onResolved(e,t,n)},e.prototype.onRejected=function(e,t,n){this.observable&&this.observable.onRejected(e,t,n)},e}();l.ChangingInfo=o;var s=function(){function s(e,t,n,r,o,i,s){this.key=e,this.action=t,this.success=n,this.value=r,this.oldValue=o,this.valueRequest=i,this.error=s}return Object.defineProperty(s.prototype,"hasChanged",{get:function(){return this.oldValue===this.value},enumerable:!0,configurable:!0}),s.success=function(e,t,n,r,o,i){return r?!0===r&&(r=t===n?"none":"update"):r=e?t===n?"none":void 0===t?"add":void 0===n?"remove":"update":t===n?"none":"update",new s(e,r,!0,t,n,4<arguments.length?o:t,i)},s.fail=function(e,t,n,r){return new s(e,"none",!1,t,t,n,r)},s.push=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];if(e){var r=-1;t.forEach(function(n){n&&n.key&&(e.some(function(e,t){return e.key===n.key&&(r=t,!0)}),0<=r?e[r]=n:e.push(n))})}},s}();l.ChangedInfo=s}(DataSense||(DataSense={})),"function"==typeof define?(define.amd||"undefined"!=typeof __webpack_require__)&&define(["exports"],function(e){return DataSense}):"function"==typeof require&&"object"==typeof exports&&"object"==typeof module&&(module.exports=DataSense),function(f){var e=function(){function u(e){var n=new f.DisposableArray;if(e instanceof u&&e._instance)return this._instance=__assign({},e._instance,{pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}}),this.propChanging=e.propChanging.createObservable(),this.propChanged=e.propChanged.createObservable(),this.propChangeFailed=e.propChangeFailed.createObservable(),this.propBroadcastReceived=e.propBroadcastReceived.createObservable(),this.propNotifyReceived=e.propNotifyReceived.createObservable(),this.anyPropChanging=e.anyPropChanging.createObservable(),this.anyPropChanged=e.anyPropChanged.createObservable(),this.anyPropChangeFailed=e.anyPropChangeFailed.createObservable(),this.propsChanged=e.propsChanged.createObservable(),this.broadcastReceived=e.broadcastReceived.createObservable(),this.notifyReceived=e.notifyReceived.createObservable(),this.pushDisposable(this.propChanging,this.propChanged,this.propChangeFailed,this.propBroadcastReceived,this.propNotifyReceived,this.anyPropChanging,this.anyPropChanged,this.anyPropChangeFailed,this.propsChanged,this.broadcastReceived,this.notifyReceived),void e.pushDisposable(this);var o=f.Access.propsAccessor();this.propChanging=o.propChanging,this.propChanged=o.propChanged,this.propChangeFailed=o.propChangeFailed,this.propBroadcastReceived=o.propBroadcastReceived,this.propNotifyReceived=o.propNotifyReceived,this.anyPropChanging=o.anyPropChanging,this.anyPropChanged=o.anyPropChanged,this.anyPropChangeFailed=o.anyPropChangeFailed,this.propsChanged=o.propsChanged,this.broadcastReceived=o.broadcastReceived,this.notifyReceived=o.notifyReceived,n.pushDisposable(this.propChanging,this.propChanged,this.propChangeFailed,this.propBroadcastReceived,this.propNotifyReceived,this.anyPropChanging,this.anyPropChanged,this.anyPropChangeFailed,this.propsChanged,this.broadcastReceived,this.notifyReceived);var r={hasProp:function(e){return o.accessor.hasProp(e)},getProp:function(e){return o.accessor.getProp(e)},getPropKeys:function(){return o.accessor.getPropKeys()},setProp:function(e,t,n){return o.accessor.setProp(e,t,n)},removeProp:function(e,t){return o.accessor.removeProp(e,t)},batchProp:function(e,t){return o.accessor.batchProp(e,t)},forceUpdateProp:function(e){o.accessor.forceUpdateProp(e)}},i=function(e,t,n){var r;o.sendPropRequest(e,t,n,(r=e,{get:function(){return o.accessor.getProp(r)},set:function(e,t){return o.accessor.setProp(r,e,t)},forceUpdate:function(){o.accessor.forceUpdateProp(r)}}))},s=function(e,t){o.sendRequest(e,t,r)},a=function(e,t,n){o.sendPropBroadcast(e,t,n)},c=function(e,t){o.sendBroadcast(e,t)};if(this._instance={has:function(e){return o.accessor.hasProp(e)},get:function(e){return o.accessor.getProp(e)},keys:function(){return o.accessor.getPropKeys()},pushFlows:function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return o.pushFlows.apply(o,[e].concat(t))},clearFlows:function(e){return o.clearFlows(e)},sendPropRequest:function(e,t,n){i(e,t,n)},sendRequest:function(e,t){s(e,t)},sendPropBroadcast:function(e,t,n){a(e,t,n)},sendBroadcast:function(e,t){c(e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.pushDisposable.apply(n,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n.removeDisposable.apply(n,e)},dispose:function(){n.dispose()}},"function"==typeof e){var t=e.additionalEvents;t&&(t.broadcastReceived instanceof f.SingleEventObservable&&(this.broadcastReceived=t.broadcastReceived,this.pushDisposable(this.broadcastReceived)),t.propBroadcastReceived instanceof f.EventObservable&&(this.propBroadcastReceived=t.propBroadcastReceived,this.pushDisposable(this.propBroadcastReceived)),t.notifyReceived instanceof f.SingleEventObservable&&(this.notifyReceived=t.notifyReceived,this.pushDisposable(this.notifyReceived)),t.propNotifyReceived instanceof f.EventObservable&&(this.propNotifyReceived=t.propNotifyReceived,this.pushDisposable(this.propNotifyReceived)),"function"==typeof t.sendRequest&&(s=t.sendRequest),"function"==typeof t.sendPropRequest&&(i=t.sendPropRequest),"function"==typeof t.sendBroadcast&&(c=t.sendBroadcast),"function"==typeof t.sendPropBroadcast&&(a=t.sendPropBroadcast)),e(o.accessor)}}return u.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},u.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},u.prototype.getKeys=function(){return this._instance.keys()},u.prototype.hasProp=function(e){return this._instance.has(e)},u.prototype.getProp=function(e){return this._instance.get(e)},u.prototype.registerChangeFlow=function(e){for(var t,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return(t=this._instance).pushFlows.apply(t,[e].concat(n))},u.prototype.clearChangeFlow=function(e){return this._instance.clearFlows(e)},u.prototype.onPropChanging=function(e,t,n,r,o){return this.propChanging.on(e,t,n,r,o)},u.prototype.onPropChanged=function(e,t,n,r,o){return this.propChanged.on(e,t,n,r,o)},u.prototype.onPropChangeFailed=function(e,t,n,r,o){return e&&"string"==typeof e?this.propChangeFailed.on(e,t,n,r,o):f.EventObservable.createFailedOnResult(null)},u.prototype.onAnyPropChanging=function(e,t,n,r){return this.anyPropChanging.on(e,t,n,r)},u.prototype.onAnyPropChanged=function(e,t,n,r){return this.anyPropChanged.on(e,t,n,r)},u.prototype.onAnyPropChangeFailed=function(e,t,n,r){return this.anyPropChangeFailed.on(e,t,n,r)},u.prototype.onPropsChanged=function(e,t,n,r){return this.propsChanged.on(e,t,n,r)},u.prototype.onPropBroadcastReceived=function(e,t,n,r,o){return this.propBroadcastReceived.on(e,t,n,r,o)},u.prototype.onBroadcastReceived=function(e,t,n,r){return this.broadcastReceived.on(e,t,n,r)},u.prototype.onPropNotifyReceived=function(e,t,n,r,o){return this.propNotifyReceived.on(e,t,n,r,o)},u.prototype.onNotifyReceived=function(e,t,n,r){return this.notifyReceived.on(e,t,n,r)},u.prototype.subscribeProp=function(e,t,n){return this.propChanged.subscribeSingle(e,t,n,function(e){return e.value})},u.prototype.subscribeProps=function(e,t){return this.propsChanged.subscribeWithConvertor(e,t,function(e){return e.changes})},u.prototype.sendPropRequest=function(e,t,n){this._instance.sendPropRequest(e,t,n)},u.prototype.sendRequest=function(e,t){this._instance.sendRequest(e,t)},u.prototype.sendPropBroadcast=function(e,t,n){this._instance.sendPropBroadcast(e,t,n)},u.prototype.sendBroadcast=function(e,t){this._instance.sendBroadcast(e,t)},u.prototype.createPropObservable=function(t){var n=this,r={};this.propBroadcastReceived.createSingleObservable(t),this.propNotifyReceived.createSingleObservable(t);var e=new f.ValueObservable(function(e){e.set(n.getProp(t)),r.accessor=e}),o=this.onPropChanging(t,function(e,t){var n=r.accessor.customizedSet(e.currentValue,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))});return e.pushDisposable(o),e},u.prototype.createObservable=function(){return new u(this)},u.prototype.copyModel=function(){var t=this,n={};return this.getKeys().forEach(function(e){n[e]=t.getProp(e)}),n},u.prototype.toJSON=function(){var e=this.copyModel();try{if(null!=e)return JSON.stringify(e)}catch(e){}return new String(e).toString()},u.prototype.dispose=function(){this._instance.dispose()},u}(),n=function(p){function e(t,n,e,r,o,i,s,a){var c=this,u=function(e){e.batchProp(t),n(e.customizedSetProp)};if(a&&(u.additionalEvents=a),c=p.call(this,u)||this,"function"==typeof e&&(c._propSetter=e),"function"==typeof r&&(c._sendPropNotify=r),"function"==typeof o&&(c._sendNotify=o),"function"==typeof i&&(c._registerPropRequestHandler=i),"function"==typeof s&&(c._registerRequestHandler=s),"undefined"!=typeof Proxy)return c.proxy=new Proxy({},{has:function(e,t){return!(!t||"string"!=typeof t)&&c.hasProp(t)},get:function(e,t,n){if(t&&"string"==typeof t)return c.getProp(t)},set:function(e,t,n,r){if(!t||"string"!=typeof t)throw new TypeError("the property key should be a string");return c.setProp(t,n)},ownKeys:function(e){return c.getKeys()},enumerate:function(e){return c.getKeys()}}),c}return __extends(e,p),e.prototype.setProp=function(e,t,n){if("function"!=typeof this._propSetter)return!1;var r=this._propSetter(e,t,n);return!!r&&r.success},e.prototype.setPropForDetails=function(e,t,n){return"function"!=typeof this._propSetter?f.ChangedInfo.fail(null,void 0,t,"not implemented"):this._propSetter(e,t,n)},e.prototype.setPromiseProp=function(n,e,t,r){var o=this;return f.Access.setPromise(function(e,t){return o.setPropForDetails(n,e,t)},e,t,r)},e.prototype.setSubscribeProp=function(n,e,t,r,o){var i=this;return f.Access.setSubscribe(function(e,t){return i.setPropForDetails(n,e,t)},e,t,r,o)},e.prototype.sendPropNotify=function(e,t,n){"function"==typeof this._sendPropNotify&&this._sendPropNotify(e,t,n)},e.prototype.sendNotify=function(e,t){"function"==typeof this._sendNotify&&this._sendNotify(e,t)},e.prototype.registerPropRequestHandler=function(e,t,n){return"function"==typeof this._registerPropRequestHandler&&this._registerPropRequestHandler(e,t,n)},e.prototype.registerRequestHandler=function(e,t){return"function"==typeof this._registerRequestHandler&&this._registerRequestHandler(e,t)},e}(f.PropsObservable=e);f.PropsClient=n;var t=function(e){function t(){var t,o=this;if((o=e.call(this,function(e){return t=e})||this)._accessor=t,"undefined"!=typeof Proxy)return o.proxy=new Proxy({},{has:function(e,t){return!(!t||"string"!=typeof t)&&o.hasProp(t)},get:function(e,t,n){if(t&&"string"==typeof t)return o.getProp(t)},set:function(e,t,n,r){if(!t||"string"!=typeof t)throw new TypeError("the property key should be a string");return o.setProp(t,n)},ownKeys:function(e){return o.getKeys()},enumerate:function(e){return o.getKeys()}}),o}return __extends(t,e),Object.defineProperty(t.prototype,"formatter",{get:function(){return this._accessor.getFormatter()},set:function(e){this._accessor.setFormatter(e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"validator",{get:function(){return this._accessor.getValidator()},set:function(e){this._accessor.setValidator(e)},enumerable:!0,configurable:!0}),t.prototype.forceUpdateProp=function(e,t){this._accessor.forceUpdateProp(e,t)},t.prototype.setProp=function(e,t,n){var r=this._accessor.setProp(e,t,n);return!!r&&r.success},t.prototype.setPropForDetails=function(e,t,n){return this._accessor.setProp(e,t,n)},t.prototype.setPromiseProp=function(n,e,t,r){var o=this;return f.Access.setPromise(function(e,t){return o.setPropForDetails(n,e,t)},e,t,r)},t.prototype.setSubscribeProp=function(n,e,t,r,o){var i=this;return f.Access.setSubscribe(function(e,t){return i.setPropForDetails(n,e,t)},e,t,r,o)},t.prototype.removeProp=function(e,t){return this._accessor.removeProp(e,t)},t.prototype.setProps=function(e,t){return this._accessor.batchProp(e,t)},t.prototype.sendPropNotify=function(e,t,n){this._accessor.sendPropNotify(e,t,n)},t.prototype.sendNotify=function(e,t){this._accessor.sendNotify(e,t)},t.prototype.registerPropRequestHandler=function(e,t,n){return this._accessor.registerPropRequestHandler(e,t,n)},t.prototype.registerRequestHandler=function(e,t){return this._accessor.registerRequestHandler(e,t)},t.prototype.createPropClient=function(n){var e,o=this,t=new f.ValueClient(this.getProp(n),function(r){e=o.onPropChanging(n,function(e,t){var n=r(e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t){return o.setPropForDetails(n,e,t)},function(e,t){o._accessor.sendPropNotify(n,e,t)},function(e,t){return o._accessor.registerPropRequestHandler(n,e,t)},{broadcastReceived:this.propBroadcastReceived.createSingleObservable(n),notifyReceived:this.propNotifyReceived.createSingleObservable(n),sendRequest:function(e,t){o.sendPropRequest(n,e,t)},sendBroadcast:function(e,t){o.sendPropBroadcast(n,e,t)}});return t.pushDisposable(e),t},t.prototype.createClient=function(){var e,o=this,t=new n(this.copyModel(),function(r){e=o.onAnyPropChanging(function(e,t){var n=r(e.key,e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t,n){return o.setPropForDetails(e,t,n)},this._accessor.sendPropNotify,this._accessor.sendNotify,this.registerPropRequestHandler,this.registerRequestHandler,{propBroadcastReceived:this.propBroadcastReceived.createObservable(),broadcastReceived:this.broadcastReceived.createObservable(),propNotifyReceived:this.propNotifyReceived.createObservable(),notifyReceived:this.notifyReceived.createObservable(),sendPropRequest:function(e,t,n){o.sendPropRequest(e,t,n)},sendRequest:function(e,t){o.sendRequest(e,t)},sendPropBroadcast:function(e,t,n){o.sendPropBroadcast(e,t,n)},sendBroadcast:function(e,t){o.sendBroadcast(e,t)}});return t.pushDisposable(e),this.pushDisposable(t),t},t}(e);f.PropsController=t}(DataSense||(DataSense={})),function(e){var t=function(){function l(){var r=this;this._options={},this._h=[];var o,i,s,a=new Date,c=0,u=0,p=function(t){o=null;var n=i;i=new Date,c<Number.MAX_SAFE_INTEGER&&c++,r._h.forEach(function(e){e(t,{initDate:a,processDate:i,latestProcessDate:n,count:c,hitCount:u})})};this._abort=function(){o&&clearTimeout(o),o=null},this._proc=function(e){var t=new Date;u++;var n=r._options;if((!n.span||!s||t.getTime()-s.getTime()>n.span)&&(u=1),s=new Date,!(null!=n.minCount&&u<n.minCount||null!=n.maxCount&&u>n.maxCount)){if(o)if("debounce"===n.mergeMode)clearTimeout(o);else if("mono"===n.mergeMode)return;null==n.delay||!1===n.delay?p(e):!0===n.delay?o=setTimeout(function(){p(e)},0):"number"==typeof n.delay&&(o=setTimeout(function(){p(e)},n.delay))}}}return l.prototype.setOptions=function(e,t){t?e&&(this._options=__assign({},this._options,e)):this._options=e||{}},l.prototype.pushHandler=function(){for(var n=this,e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];var r=0;return e.forEach(function(e){var t;"function"==typeof e?r+=n._h.push(e):e instanceof Array&&(r+=(t=n._h).push.apply(t,e))}),r},l.prototype.clearHandler=function(){this._h=[]},l.prototype.process=function(e){this._proc(e)},l.prototype.abort=function(){this._abort()},l.delay=function(e,t){var n;return null==t||!1===t?e():!0===t?n=setTimeout(function(){n=null,e()},0):"number"==typeof t&&(n=setTimeout(function(){n=null,e()},t)),{dispose:function(){n&&clearTimeout(n),n=null}}},l.throttle=function(e,t,n){var r=new l;return r.setOptions({span:t,maxCount:1}),r.pushHandler(e),n||r.process(),r},l.debounce=function(e,t,n){var r=new l;return r.setOptions({delay:t,mergeMode:"debounce"}),r.pushHandler(e),n||r.process(),r},l.mono=function(e,t,n){var r=new l;return r.setOptions({delay:t,mergeMode:"mono"}),r.pushHandler(e),n||r.process(),r},l.multiHit=function(e,t,n,r,o){var i=new l;return i.setOptions({minCount:t,maxCount:n,span:r}),i.pushHandler(e),o||i.process(),i},l.schedule=function(t,r){var n,o,i,s,a,c,u=function(){o&&o.dispose(),o=null,n&&(clearInterval(n),n=null)},p=function(e){s=new Date,t({startDate:i,latestStopDate:a,processDate:s,latestProcessDate:c,span:r,source:e}),c=new Date},f=function(e,t){!1,u(),o=l.delay(function(){o=null,p(t),n=setInterval(function(){p("schedule")},r)},e)};return{start:function(e){var t=!1,n=e?"plan":"start";"number"==typeof e?t=e:!0===e&&(t=r),f(t,n)},process:function(){p("immediate")},resume:function(e){n||o||f(e,"resume")},pause:function(){u(),a=new Date},stop:function(){u(),a=new Date,!0},get alive(){return n||o}}},l}();e.HitTask=t}(DataSense||(DataSense={})),function(f){var r=function(){function p(e){var n,r,o=new f.DisposableArray,i="value";if(e instanceof p&&e._instance)return this._instance=__assign({},e._instance,{pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.pushDisposable.apply(o,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.removeDisposable.apply(o,e)},dispose:function(){o.dispose()}}),this.changing=e.changing.createObservable(),this.changed=e.changed.createObservable(),this.changeFailed=e.changeFailed.createObservable(),this.broadcastReceived=e.broadcastReceived.createObservable(),this.notifyReceived=e.notifyReceived.createObservable(),this.pushDisposable(this.changing,this.changed,this.changeFailed,this.broadcastReceived,this.notifyReceived),void e.pushDisposable(this);var s=f.Access.propsAccessor();s.accessor.setFormatter(function(e,t){return"function"!=typeof n||e!==i?t:n(t)}),s.accessor.setValidator(function(e,t){return"function"!=typeof r||e!==i||r(t)}),this.changing=s.propChanging.createSingleObservable(i),this.changed=s.propChanged.createSingleObservable(i),this.changeFailed=s.propChangeFailed.createSingleObservable(i),this.broadcastReceived=s.propBroadcastReceived.createSingleObservable(i),this.notifyReceived=s.propNotifyReceived.createSingleObservable(i),o.pushDisposable(this.changing,this.changed,this.changeFailed,this.broadcastReceived,this.notifyReceived);var a={get:function(){return s.accessor.getProp(i)},set:function(e,t){return s.accessor.setProp(i,e,t)},forceUpdate:function(e){s.accessor.forceUpdateProp(i,e)}},c=function(e,t){s.sendPropRequest(i,e,t,a)},u=function(e,t){s.sendPropBroadcast(i,e,t)};if(this._instance={get:function(){return s.accessor.getProp(i)},pushFlows:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.pushFlows.apply(s,[i].concat(e))},clearFlows:function(){return s.clearFlows(i)},sendRequest:function(e,t){c(e,t)},sendBroadcast:function(e,t){u(e,t)},pushDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.pushDisposable.apply(o,e)},removeDisposable:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return o.removeDisposable.apply(o,e)},dispose:function(){o.dispose()}},"function"==typeof e){var t=e.additionalEvents;t&&(t.broadcastReceived instanceof f.SingleEventObservable&&(this.broadcastReceived=t.broadcastReceived,this.pushDisposable(this.broadcastReceived)),t.notifyReceived instanceof f.SingleEventObservable&&(this.notifyReceived=t.notifyReceived,this.pushDisposable(this.notifyReceived)),"function"==typeof t.sendRequest&&(c=t.sendRequest),"function"==typeof t.sendBroadcast&&(u=t.sendBroadcast)),e({get:function(){return s.accessor.getProp(i)},set:function(e,t){return s.accessor.setProp(i,e,t)},customizedSet:function(e,t){return s.accessor.customizedSetProp(i,e,t)},forceUpdate:function(e){s.accessor.forceUpdateProp(i,e)},getFormatter:function(){return n},setFormatter:function(e){n=e},getValidator:function(){return r},setValidator:function(e){r=e},getStore:function(e){return s.accessor.getPropStore(i,e)},setStore:function(e,t){s.accessor.setPropStore(i,e,t)},removeStore:function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];(e=s.accessor).removePropStore.apply(e,[i].concat(t))},sendNotify:function(e,t){s.accessor.sendPropNotify(i,e,t)},registerRequestHandler:function(e,t){return s.accessor.registerPropRequestHandler(i,e,t)}})}}return p.prototype.pushDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushDisposable.apply(e,t)},p.prototype.removeDisposable=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).removeDisposable.apply(e,t)},p.prototype.get=function(){return this._instance.get()},p.prototype.getType=function(){return typeof this._instance.get()},p.prototype.instanceOf=function(e){return this._instance.get()instanceof e},p.prototype.registerChangeFlow=function(){for(var e,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return(e=this._instance).pushFlows.apply(e,t)},p.prototype.clearChangeFlow=function(){return this._instance.clearFlows()},p.prototype.onChanging=function(e,t,n,r){return this.changing.on(e,t,n,r)},p.prototype.onChanged=function(e,t,n,r){return this.changed.on(e,t,n,r)},p.prototype.onChangeFailed=function(e,t,n,r){return this.changeFailed.on(e,t,n,r)},p.prototype.onBroadcastReceived=function(e,t,n,r){return this.broadcastReceived.on(e,t,n,r)},p.prototype.onNotifyReceived=function(e,t,n,r){return this.notifyReceived.on(e,t,n,r)},p.prototype.subscribe=function(e,t){return this.changed.subscribeWithConvertor(e,t,function(e){return e.value})},p.prototype.sendRequest=function(e,t){this._instance.sendRequest(e,t)},p.prototype.sendBroadcast=function(e,t){this._instance.sendBroadcast(e,t)},p.prototype.createObservable=function(){return new p(this)},p.prototype.dispose=function(){this._instance.dispose()},p.prototype.toJSON=function(){var e=this._instance.get();try{if(null!=e)return JSON.stringify(e)}catch(e){}return new String(e).toString()},p}(),o=function(c){function e(t,n,e,r,o,i){var s=this,a=function(e){e.set(t),n(e.customizedSet)};return i&&(a.additionalEvents=i),s=c.call(this,a)||this,"function"==typeof e&&(s._setter=e),"function"==typeof r&&(s._sendNotify=r),"function"==typeof o&&(s._registerRequestHandler=o),s}return __extends(e,c),e.prototype.set=function(e,t){if("function"!=typeof this._setter)return!1;var n=this._setter(e,t);return!!n&&n.success},e.prototype.setForDetails=function(e,t){return"function"!=typeof this._setter?f.ChangedInfo.fail(null,void 0,e,"not implemented"):this._setter(e,t)},e.prototype.setPromise=function(e,t,n){var r=this;return f.Access.setPromise(function(e,t){return r.setForDetails(e,t)},e,t,n)},e.prototype.setSubscribe=function(e,t,n,r){var o=this;return f.Access.setSubscribe(function(e,t){return o.setForDetails(e,t)},e,t,n,r)},e.prototype.sendNotify=function(e,t){this._sendNotify(e,t)},e.prototype.registerRequestHandler=function(e,t){return"function"==typeof this._registerRequestHandler&&this._registerRequestHandler(e,t)},e}(f.ValueObservable=r);f.ValueClient=o;var e=function(n){function e(){var t,e=this;return(e=n.call(this,function(e){return t=e})||this)._accessor=t,e}return __extends(e,n),Object.defineProperty(e.prototype,"formatter",{get:function(){return this._accessor.getFormatter()},set:function(e){this._accessor.setFormatter(e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"validator",{get:function(){return this._accessor.getValidator()},set:function(e){this._accessor.setValidator(e)},enumerable:!0,configurable:!0}),e.prototype.set=function(e,t){var n=this._accessor.set(e,t);return!!n&&n.success},e.prototype.setForDetails=function(e,t){return this._accessor.set(e,t)},e.prototype.setPromise=function(e,t,n){var r=this;return f.Access.setPromise(function(e,t){return r.setForDetails(e,t)},e,t,n)},e.prototype.setSubscribe=function(e,t,n,r){var o=this;return f.Access.setSubscribe(function(e,t){return o.setForDetails(e,t)},e,t,n,r)},e.prototype.registerRequestHandler=function(e,t){return this._accessor.registerRequestHandler(e,t)},e.prototype.observe=function(e,t,n){return e instanceof r?(this._observing=e.registerChangeFlow(this._accessor.customizedSet),t||this._accessor.customizedSet(e.get(),n).resolve(),this._observing):{sync:function(){},dispose:function(){}}},e.prototype.stopObserving=function(){var e=this._observing;e&&(delete this._observing,"function"==typeof e.dispose&&e.dispose())},e.prototype.syncFromObserved=function(e){var t=this._observing;return!(!t||"function"!=typeof t.sync)&&(t.sync(e),!0)},e.prototype.isObserving=function(){return!!this._observing},e.prototype.createClient=function(){var e,n=this,t=new o(this.get(),function(r){e=n.onChanging(function(e,t){var n=r(e.valueRequest,t.message);e.observable&&(e.observable.onResolved(function(e){n.resolve(e)}),e.observable.onRejected(function(e){n.reject(e)}))})},function(e,t){return n.setForDetails(e,t)},this._accessor.sendNotify,this._accessor.registerRequestHandler,{broadcastReceived:this.broadcastReceived.createObservable(),notifyReceived:this.notifyReceived.createObservable(),sendRequest:function(e,t){n.sendRequest(e,t)},sendBroadcast:function(e,t){n.sendBroadcast(e,t)}});return t.pushDisposable(e),this.pushDisposable(t),t},e.prototype.sendNotify=function(e,t){this._accessor.sendNotify(e,t)},e}(r);f.ValueController=e}(DataSense||(DataSense={}));